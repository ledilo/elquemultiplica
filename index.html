<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Zona Oculta</title>
  <meta name="description" content="Crea tu usuario en minutos." />
  <meta name="color-scheme" content="dark" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;800&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#000;
      --text:#fff;
      --muted:#b6c3d3;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;overflow:hidden}
    body{
      background:var(--bg) url('bg.jpg') center/cover no-repeat fixed;
      color:var(--text);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center
    }
    .logo{max-width:140px;width:60%;height:auto;margin-bottom:12px;filter:drop-shadow(0 6px 16px rgba(0,0,0,.8))}
    .bonus-img{max-width:260px;width:75%;height:auto;margin:0 auto 10px;filter:drop-shadow(0 8px 20px rgba(0,0,0,.6))}
    .minimo{font-size:16px;color:var(--muted);margin-bottom:16px;font-weight:600}
    .btn-wa{display:inline-block;animation:floaty 3s ease-in-out infinite, glow 2.5s ease-in-out infinite alternate}
    .btn-wa img{width:240px;height:auto;display:block}
    @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
    @keyframes glow{
      0%{filter:drop-shadow(0 0 0 rgba(37,211,102,.0))}
      100%{filter:drop-shadow(0 0 12px rgba(37,211,102,.6))}
    }
    footer{padding:10px;color:#9fb3c8;font-size:12px;text-align:center;width:100%;background:transparent;position:absolute;bottom:0;left:0}
  </style>
</head>
<body>
  <!-- LOGO -->
  <img src="logo.png" alt="Logo" class="logo"/>
  <!-- BONO -->
  <img src="bonus.png" alt="BONO" class="bonus-img"/>
  <!-- Minimo -->
  <div class="minimo">Mínimo de carga: $1000</div>
  <!-- BOTÓN WA -->
  <a class="btn-wa" id="waLink" href="#" target="_blank" rel="noopener">
    <img src="wa-btn.png" alt="WhatsApp"/>
  </a>

  <footer>
    +18 | Entretenimiento
  </footer>

  <!-- Meta Pixel Code -->
  <script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1357163665768287');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1357163665768287&ev=PageView&noscript=1"/></noscript>
  <!-- End Meta Pixel Code -->

  <script>
  // ==========================
  // EDITÁ TUS 5 ENLACES ACÁ
  // ==========================
  const waLinks = [
    'https://wa.link/8ygqvo', // 1
    'https://wa.link/f7wx58', // 2
    'https://wa.link/9vmbdf', // 3
    'https://wa.link/8jgm7j', // 4
    'https://wa.link/5dgya8', // 5
    'https://wa.link/4rqcdm', // 6
    'https://wa.link/8fhzsw', // 7
  ];

  function getSrcParam() {
    const p = new URLSearchParams(location.search).get('src');
    const n = Number(p);
    if (!Number.isNaN(n) && n >= 1 && n <= waLinks.length) return n;
    return null;
  }

  function pickLink() {
    const forced = getSrcParam();
    if (forced) return waLinks[forced - 1];

    const KEY = 'wa_idx';
    let idx = sessionStorage.getItem(KEY);
    if (idx !== null) return waLinks[+idx];

    idx = Math.floor(Math.random() * waLinks.length);
    sessionStorage.setItem(KEY, idx);
    return waLinks[idx];
  }

  const waBtn = document.getElementById('waLink');
  waBtn.href = pickLink();

  // Helpers cookies fbp/fbc
  function getCookie(name){
    const m = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
    return m ? m.pop() : '';
  }

  waBtn.addEventListener('click', async () => {
    // 1) generar event_id
    const event_id = 'evt_' + Math.random().toString(36).slice(2) + Date.now();

    // 2) Pixel navegador
    fbq('track', 'Subscribe', {}, { eventID: event_id });

    // 3) Conversion API (via endpoint)
    try {
      await fetch('/api/meta-subscribe', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          event_id,
          fbp: getCookie('_fbp') || undefined,
          fbc: getCookie('_fbc') || undefined
        })
      });
    } catch (e) {
      console.error('CAPI error', e);
    }
  });
</script>
